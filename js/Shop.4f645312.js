(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Shop"],{"03af":function(t,e,i){"use strict";var s=i("9f8f"),a=i.n(s);a.a},"08b7":function(t,e,i){},"09ab":function(t,e,i){"use strict";var s=i("33a7"),a=i.n(s);a.a},"13c1":function(t,e,i){},1811:function(t,e,i){"use strict";var s=i("18cf"),a=i.n(s);a.a},"18cf":function(t,e,i){},2658:function(t,e,i){},"2e90":function(t,e,i){"use strict";var s=i("d1b4"),a=i.n(s);a.a},"323a":function(t,e,i){"use strict";var s=i("2658"),a=i.n(s);a.a},"32cd":function(t,e,i){"use strict";var s=i("b089"),a=i.n(s);a.a},"33a7":function(t,e,i){},"349e":function(t,e,i){"use strict";var s=i("4729"),a=i.n(s);a.a},"3f45":function(t,e,i){"use strict";var s=i("93f6"),a=i.n(s);a.a},"43be":function(t,e,i){"use strict";var s=i("9499"),a=i.n(s);a.a},4676:function(t,e,i){"use strict";var s=i("13c1"),a=i.n(s);a.a},4729:function(t,e,i){},"4b33":function(t,e,i){},"4c13":function(t,e,i){},"6f57":function(t,e,i){"use strict";var s=i("a7d4"),a=i.n(s);a.a},"821d":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.shopDetails?i("div",{staticClass:"shop__block"},[i("ShopHeader",{attrs:{shopDetails:t.shopDetails}}),i("tabs",{attrs:{tabs:t.tabs,lazy:""}},t._l(t.tabs,function(e){return i(e.key,t._b({key:e.key,tag:"component"},"component",t.propsMap[e.key],!1))})),t.loading?i("ShopSkeleton"):t._e()],1):t._e()},a=[],n=i("a322"),o=(i("7f7f"),i("c93e")),r=i("2f62"),c=i("408b"),l=i("d50a"),u=i("e903"),_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"shop__header"},[t.shopDetails.shop_sign?i("nav",{staticClass:"shop__nav",style:{backgroundImage:"url("+t.$getImage(t.shopDetails.shop_sign.image_hash,t.shopPostImgParam)+")"}},[i("a",{staticClass:"shop__back-btn",attrs:{href:"javascript:"},on:{click:t.onBack}})]):t._e(),i("div",{staticClass:"shop__overview"},[i("div",{staticClass:"shop__logo"},[t.shopDetails.is_premium?i("tag",{staticClass:"shop__logo-tag"},[t._v("品牌")]):t._e(),i("img",{attrs:{src:t.$getImage(t.shopDetails.image_path,t.shopLogoImgParam),alt:""}})],1),i("div",{staticClass:"shop__info",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.shopInfoShow=!0}}},[i("h2",{staticClass:"shop__name"},[i("span",{staticClass:"shop__name-text"},[t._v(t._s(t.shopDetails.name))]),i("span",{staticClass:"shop__info-show-btn"})]),i("div",{staticClass:"shop__service"},[i("span",{staticClass:"shop__rating"},[t._v("评价"+t._s(t.shopDetails.rating&&t.shopDetails.rating.toFixed(1)))]),i("span",{staticClass:"shop__sales"},[t._v("月售"+t._s(t.shopDetails.recent_order_num)+"单")]),i("span",{staticClass:"shop__delivery-time"},[t._v(t._s(t.shopDetails.delivery_mode&&t.shopDetails.delivery_mode.text)+"约"+t._s(t.shopDetails.order_lead_time)+"分钟")])])]),t.shopDetails.activities&&t.shopDetails.activities.length>0?i("div",{staticClass:"shop__activity",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.activityListShow=!0}}},[i("div",{staticClass:"shop__activity-abstract"},[i("tag",{staticClass:"shop__activity-icon",style:{fontSize:t.$toRem(18),backgroundColor:"#"+t.shopDetails.activities[0].icon_color}},[t._v(t._s(t.shopDetails.activities[0].icon_name))]),i("span",[t._v(t._s(t.shopDetails.activities[0].tips))])],1),i("div",{staticClass:"shop__activity-show-btn"},[i("span",[t._v(t._s(t.shopDetails.activities.length)+"个优惠")])])]):t._e(),i("div",{staticClass:"shop__promotion"},[t._v("公告: "+t._s(t.shopDetails.promotion_info)+"\n    ")])]),i("modal",{attrs:{visible:t.shopInfoShow,panel:"center",closeBtn:"center"},on:{close:function(e){t.shopInfoShow=!1}}},[i("ShopInfo",{attrs:{shopDetails:t.shopDetails}})],1),i("modal",{attrs:{visible:t.activityListShow,panel:"bottom"},on:{close:function(e){t.activityListShow=!1}}},[i("ActivityList",{attrs:{shopDetails:t.shopDetails}})],1)],1)},d=[],m=(i("cadf"),i("551c"),i("097d"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"im__main"},[i("h2",{staticClass:"im__head"},[t.shopDetails.is_premium?i("span",{staticClass:"imc__premium-tag"},[t._v("品牌")]):t._e(),t._v("\n    "+t._s(t.shopDetails.name))]),i("div",{staticClass:"im__content"},[i("ul",{staticClass:"imc__service"},[i("li",{staticClass:"imc__service-item"},[i("h3",{staticClass:"imc__service-title imc__rating"},[t._v(t._s(t.shopDetails.rating&&t.shopDetails.rating.toFixed(1)))]),i("p",{staticClass:"imc__service-text"},[t._v("评分")])]),i("li",{staticClass:"imc__service-item"},[i("h3",{staticClass:"imc__service-title imc__sales"},[t._v(t._s(t.shopDetails.recent_order_num)+"单")]),i("p",{staticClass:"imc__service-text"},[t._v("月售")])]),i("li",{staticClass:"imc__service-item"},[i("h3",{staticClass:"imc__service-title imc__delivery-time"},[t._v(t._s(t.shopDetails.delivery_mode&&t.shopDetails.delivery_mode.text))]),i("p",{staticClass:"imc__service-text"},[t._v("约"+t._s(t.shopDetails.order_lead_time)+"分钟")])]),i("li",{staticClass:"imc__service-item"},[i("h3",{staticClass:"imc__service-title imc__delivery-fee"},[t._v(t._s(t.shopDetails.piecewise_agent_fee&&t.shopDetails.piecewise_agent_fee.rules[0].fee)+"元")]),i("p",{staticClass:"imc__service-text"},[t._v("配送费")])]),i("li",{staticClass:"imc__service-item"},[i("h3",{staticClass:"imc__service-title imc__distance"},[t._v(t._s(t._f("formatDistance")(t.shopDetails.distance)))]),i("p",{staticClass:"imc__service-text"},[t._v("距离")])])]),t._m(0),i("div",{staticClass:"imc__promotion"},[t._v(t._s(t.shopDetails.promotion_info||t.defaultPromotion))])])])}),v=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"imc__promotion-title"},[i("div",{staticClass:"imc__promotion-decoration"},[i("span",{staticClass:"imc__promotion-text"},[t._v("公告")])])])}],p=(i("c5f6"),{props:{shopDetails:Object},data:function(){return{defaultPromotion:"欢迎光临，用餐高峰期请提前下单，谢谢。"}},filters:{formatDistance:function(t){return t>=1e3?Number(t/1e3).toFixed(1)+"km":t>=0?Number(t)+"m":""}}}),f=p,h=(i("09ab"),i("2877")),g=Object(h["a"])(f,m,v,!1,null,"208c0acb",null);g.options.__file="ShopInfo.vue";var C=g.exports,b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity__container"},[i("div",{staticClass:"activity__head"},[t._v("优惠活动")]),i("div",{staticClass:"activity__content"},t._l(t.shopDetails.activities,function(e){return i("div",{key:e.id,staticClass:"activity__item"},[i("tag",{staticClass:"activity__icon",style:{fontSize:t.$toRem(26),backgroundColor:"#"+e.icon_color}},[t._v(t._s(e.icon_name))]),i("span",[t._v(t._s(e.tips))])],1)}))])},y=[],w={components:{Tag:l["c"]},props:{shopDetails:Object}},k=w,x=(i("1811"),Object(h["a"])(k,b,y,!1,null,"237a5a9d",null));x.options.__file="ActivityList.vue";var S=x.exports,I={name:"ShopHeader",components:{Tag:l["c"],Modal:l["a"],ShopInfo:C,ActivityList:S},props:{shopDetails:Object},data:function(){return{shopInfoShow:!1,activityListShow:!1,shopPostImgParam:"?imageMogr/format/webp/thumbnail/750x/",shopLogoImgParam:"?imageMogr/format/webp/thumbnail/150x/"}},methods:{onBack:function(){this.$router.back()}}},D=I,$=(i("fcd7"),Object(h["a"])(D,_,d,!1,null,"63a20db4",null));$.options.__file="ShopHeader.vue";var j=$.exports,P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.cartClient?i("div",[i("FoodMenu",{attrs:{menu:t.menu,shopDetails:t.shopDetails,entities:t.entities,selectedNums:t.selectedNums},on:{add:t.addCart,reduce:t.reduceCart,showspec:t.openSpecPanel,showdetail:t.openFoodDetail}}),i("CartView",{attrs:{entities:t.entities,minAmount:t.shopDetails&&t.shopDetails.float_minimum_order_amount,cartClient:t.cartClient},on:{addcart:t.addCart,reducecart:t.reduceCart,clearcart:t.clearCart,submitcart:t.toCheckout}}),i("modal",{attrs:{visible:t.specShow,panel:"center",closable:!1,zIndex:1001},on:{close:t.closeSpecPanel}},[i("FoodSpec",{attrs:{item:t.specItem},on:{ok:t.saveSpecPanel}})],1),i("FoodDetail",{attrs:{visible:t.foodDetailVisible,food:t.showingFood,quantity:t.selectedNums.item[t.showingFood&&t.showingFood.item_id]},on:{close:t.closeFoodDetail,add:t.addCart,reduce:t.reduceCart,showspec:t.openSpecPanel}})],1):t._e()},E=[],A=i("6bde"),F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.menu&&t.menu.length>0?i("div",{staticClass:"menu__container",style:{height:t.menuHeight}},[i("ul",{directives:[{name:"lazy-local-scroll",rawName:"v-lazy-local-scroll"}],staticClass:"menu__nav"},t._l(t.menu,function(e,s){return i("li",{key:e.id,staticClass:"menu__nav-item",class:{"menu__nav-item_active":""!==t.activeMenuItem?t.activeMenuItem===e.id:0===s},on:{click:function(i){t.changeActiveItem(e.id)}}},[i("img",{staticClass:"menu__nav-item-icon",attrs:{src:t.$getImage((""!==t.activeMenuItem?t.activeMenuItem===e.id:0===s)?e.icon_url:e.grey_icon_url,t.iconImgParam),alt:""}}),i("span",{staticClass:"menu__nav-item-text"},[t._v(t._s(e.name))]),i("span",{staticClass:"menu__nav-item-quantity"},[t._v(t._s(t.selectedNums.category[e.id]||""))])])})),i("ul",{directives:[{name:"lazy-local-scroll",rawName:"v-lazy-local-scroll"}],ref:"scroller",staticClass:"menu__list",on:{scroll:t.onScroll}},t._l(t.menu,function(e,s){return i("li",{directives:[{name:"scroll-into",rawName:"v-scroll-into",value:e.id,expression:"list.id"}],key:e.id,staticClass:"menu__list-item",class:{"menu__list-item_active":""!==t.activeMenuItem?t.activeMenuItem===e.id:0===s}},[i("div",{staticClass:"menu__list-title-wrap"},[i("strong",{staticClass:"menu__list-title"},[t._v(t._s(e.name))]),i("span",{staticClass:"menu__list-desc ellipsis"},[t._v(t._s(e.description))])]),i("ul",{staticClass:"menu__list"},t._l(e.foods,function(e){return i("li",{key:e.item_id,staticClass:"menu__list-item",on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.onShowDetail(e)}}},[i("div",{staticClass:"food__container"},[i("div",{staticClass:"food__img"},[e.attributes.length?i("tag",{staticClass:"food__attr-tag",style:{backgroundColor:"#"+e.attributes[0].icon_color}},[t._v(t._s(e.attributes[0].icon_name))]):t._e(),i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.$getImage(e.image_path,t.foodImgParam),expression:"$getImage(item.image_path, foodImgParam)"}],staticClass:"lazy-img-fadein",attrs:{alt:""}})],1),i("div",{staticClass:"food__info"},[i("div",{staticClass:"food__name ellipsis"},[t._v(t._s(e.name))]),i("div",{staticClass:"food__desc ellipsis"},[t._v(t._s(e.description))]),i("div",{staticClass:"food__sales"},[i("span",[t._v("月售"+t._s(e.month_sales)+"份")]),i("span",[t._v("好评率"+t._s(e.satisfy_rate)+"%")])]),i("strong",{staticClass:"food__price"},[i("span",[t._v(t._s(t._f("toPrice")(e.specfoods[0].price,2,!1)))]),e.specfoods[0].original_price?i("del",{staticClass:"food__original-price"},[t._v("￥"+t._s(t._f("toPrice")(e.specfoods[0].original_price,2,!1)))]):t._e()]),i("cart-button",{staticClass:"food__btns",attrs:{item:e,quantity:t.selectedNums.item[e.item_id]},on:{add:t.onAdd,reduce:t.onReduce,showspec:t.onShowSpec}})],1)])])}))])}))]):t._e()},O=[],N=(i("ac6a"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cart__entity-btns"},[t.item.attrs.length<=0?[t.quantity>0?i("a",{staticClass:"cart__entity-btn-minus",attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.onReduce(e)}}},[i("svg",[i("use",{attrs:{"xlink:href":"#cart-minus"}})])]):t._e(),t.quantity>0?i("span",{staticClass:"cart__entity-quantity"},[t._v(t._s(t.quantity))]):t._e(),i("a",{staticClass:"cart__entity-btn-add",attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.onAdd(e)}}},[i("svg",[i("use",{attrs:{"xlink:href":"#cart-add"}})])])]:[t.quantity>0?i("a",{staticClass:"cart__entity-btn-minus",attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.showToast(e)}}},[i("svg",[i("use",{attrs:{"xlink:href":"#cart-minus"}})])]):t._e(),t.quantity>0?i("span",{staticClass:"cart__entity-quantity"},[t._v(t._s(t.quantity))]):t._e(),i("a",{staticClass:"cart__entity-btn-spec",attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.onShowSpec(e)}}},[i("span",{staticClass:"cart__entitiy-btn-specBtn"},[t._v("选规格")])])]],2)}),R=[],L={props:{item:{type:Object,required:!0},quantity:{type:Number,default:0}},data:function(){return{}},computed:{},methods:{onAdd:function(){this.$emit("add",Object(o["a"])({},this.item,this.item.specfoods[0]))},onReduce:function(){this.$emit("reduce",Object(o["a"])({},this.item,this.item.specfoods[0]))},onShowSpec:function(){this.$emit("showspec",this.item)},showToast:function(){l["d"].open({content:"多规格食品只能在购物车中减少数量",mask:!1})}}},q=L,T=(i("862c"),Object(h["a"])(q,N,R,!1,null,"ee7c7c8e",null));T.options.__file="CartButton.vue";var M=T.exports,V=i("2b0e");i.e("vue-lazy-load").then(i.t.bind(null,"283e",7)).then(function(t){return V["a"].use(t,{preload:3,attempt:5})});var B={name:"FoodMenu",components:{Tag:l["c"],CartButton:M},filters:{toPrice:function(t,e,i){var s=(t||0).toFixed(e||2);return i?s:String(Number(s))}},props:{shopDetails:{type:Object,required:!0},menu:{type:Array,required:!0},entities:{type:Array,required:!0},selectedNums:{type:Object}},data:function(){return{activeMenuItem:"",needToScroll:!1,menuScroller:null,menuScrollItems:[],iconImgParam:"?imageMogr/format/webp/thumbnail/26x/",foodImgParam:"?imageMogr/format/webp/thumbnail/!140x140r/gravity/Center/crop/140x140/"}},computed:{menuHeight:function(){return window.innerHeight-window.innerWidth/750*80+"px"}},methods:{onShowDetail:function(t){this.$emit("showdetail",t)},onAdd:function(t){this.$emit("add",t)},onReduce:function(t){this.$emit("reduce",t)},onShowSpec:function(t){this.$emit("showspec",t)},onScroll:function(){var t=this.$refs.scroller||window;if(t){var e,i=t.getBoundingClientRect().top;this.menuScrollItems.forEach(function(t){var s=t.el,a=t.key,n=s.getBoundingClientRect().top;n-i<1&&(e=a)}),e&&(this.activeMenuItem=e)}},changeActiveItem:function(t){this.activeMenuItem=t,this.needToScroll=!0}},watch:{foodDetailVisible:function(t){t?(document.documentElement.style.overflowY="hidden",document.body.style.overflowY="scroll"):(document.documentElement.style.overflowY="",document.body.style.overflowY="")}},directives:{scrollInto:{bind:function(t,e,i){i.context.menuScrollItems.push({el:t,key:i.key})},update:function(t,e,i){var s=e.value,a=i.context,n=a.needToScroll,o=a.activeMenuItem;n&&o===s&&(i.context.needToScroll=!1,t.scrollIntoView())}}}},H=B,z=(i("a7da"),Object(h["a"])(H,F,O,!1,null,"38aec226",null));z.options.__file="FoodMenu.vue";var Y=z.exports,U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.cartClient?i("div",{staticClass:"cartview"},[i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"cartview__mask",on:{click:t.hideCart}})]),i("div",{staticClass:"cartview__panel"},[i("div",{staticClass:"cartview__discount-tip"},[t._v(t._s(t.cart.agent_fee_tip))]),i("collapse-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"cartview__content"},[i("div",{staticClass:"cartview__header"},[i("div",{staticClass:"cartview__title"},[t._v("已选商品")]),i("a",{staticClass:"cartview__btn-clear",attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.onClearCart(e)}}},[i("svg",[i("use",{attrs:{"xlink:href":"#cart-remove"}})]),i("span",[t._v("清空")])])]),i("ul",{staticClass:"cartview__entitylist"},[t._l(t.entities,function(e,s){return i("li",{key:e.id+s,staticClass:"entityitem"},[i("div",{staticClass:"entityitem__info ellipsis"},[i("div",{staticClass:"entityitem__name"},[t._v(t._s(e.name))]),e.attrs&&e.attrs.length>0?i("div",{staticClass:"entityitem__attrs ellipsis"},[t._v(t._s(e.attrs[0]&&e.attrs[0].value)+" ")]):t._e()]),i("div",{staticClass:"entityitem__price"},[t._v(t._s(e.price))]),i("div",{staticClass:"entityitem__cart-btns"},[i("a",{staticClass:"entityitem__entity-btn-minus",attrs:{href:"javascript:"},on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.onReduceCart(e)}}},[i("svg",[i("use",{attrs:{"xlink:href":"#cart-minus"}})])]),i("span",{staticClass:"entityitem__entity-quantity"},[t._v(t._s(e.quantity))]),i("a",{staticClass:"entityitem__entity-btn-add",attrs:{href:"javascript:"},on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.onAddCart(e)}}},[i("svg",[i("use",{attrs:{"xlink:href":"#cart-add"}})])])])])}),i("li",{staticClass:"entityitem"},[i("div",{staticClass:"entityitem__info"},[t._v("餐盒")]),i("div",{staticClass:"entityitem__price"},[t._v(t._s(t.total.packingFee))]),i("div",{staticClass:"entityitem__cart-btns"})])],2)])])],1),i("div",{staticClass:"cartbar"},[i("a",{staticClass:"cartbar__btn-toggle-panel",attrs:{href:"javascript:"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleShow(e)}}},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.entities.length,expression:"entities.length"}],staticClass:"cartbar__badge"},[t._v(t._s(t.total.quantity))])]),i("a",{staticClass:"cartbar__btn-toggle-panel cartbar__btn-toggle-panel_empty",style:{visibility:t.entities.length<=0?"visible":"hidden"},attrs:{href:"javascript:"}}),i("div",{staticClass:"cartbar__total-price"},[t._v("¥"+t._s(t.total.price)+"\n        "),i("div",{staticClass:"cartbar__delivery-fee"},[t._v(t._s(t.cart.agent_fee_tip))])]),t.checkoutButton?i("a",{staticClass:"cartbar__btn-checkout",class:{"cartbar__btn-checkout_disabled":"forbidden"===t.checkoutButton.action},attrs:{href:"javascript:"}},["checkout"===t.checkoutButton.action?i("span",{on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toCheckout(e)}}},[t._v(t._s(t.checkoutButton.text))]):t._e(),"forbidden"===t.checkoutButton.action?i("span",[t._v(t._s(t.checkoutButton.forbidden_reason.content))]):t._e()]):t._e()])],1):t._e()},G=[],X=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"collapse"},on:{beforeEnter:t.beforeEnter,afterEnter:t.afterEnter,beforeLeave:t.beforeLeave,afterLeave:t.afterLeave}},[t._t("default")],2)},J=[],W={methods:{beforeEnter:function(t){requestAnimationFrame(function(){t.style.height=0,requestAnimationFrame(function(){t.style.height=t.scrollHeight+"px"})})},afterEnter:function(t){t.style.height=""},beforeLeave:function(t){requestAnimationFrame(function(){t.style.height=t.scrollHeight+"px",requestAnimationFrame(function(){t.style.height=0})})},afterLeave:function(t){t.style.height=""}}},K=W,Q=(i("32cd"),Object(h["a"])(K,X,J,!1,null,"ebe55e5c",null));Q.options.__file="CollapseTransition.vue";var Z=Q.exports,tt={components:{CollapseTransition:Z},props:{entities:{type:Array,default:function(){return[]}},minAmount:{type:Number,default:0},cartClient:{type:Object}},data:function(){return{show:!1}},computed:{total:function(){return this.entities.reduce(function(t,e){return Object(o["a"])({},t,{price:1*(t.price+=e.price*e.quantity).toFixed(1),quantity:1*(t.quantity+=e.quantity).toFixed(1),packingFee:1*(t.packingFee+=e.packing_fee*e.quantity).toFixed(1)})},{price:0,quantity:0,packingFee:0})},delievryFee:function(){return 0},diffAmount:function(){return this.minAmount-this.total.price},cart:function(){return this.cartClient&&this.cartClient.cart||{}},checkoutButton:function(){return this.cartClient&&this.cartClient.checkout_button_v2}},methods:{hideCart:function(){this.show=!1},toggleShow:function(){this.show=!this.show},onAddCart:function(t){this.$emit("addcart",t)},onReduceCart:function(t){this.$emit("reducecart",t)},onClearCart:function(){this.$emit("clearcart")},toCheckout:function(){this.$emit("submitcart")}},watch:{entities:function(t){t.length>0||this.hideCart()}}},et=tt,it=(i("9ca5"),Object(h["a"])(et,U,G,!1,null,"35723c04",null));it.options.__file="CartView.vue";var st=it.exports,at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.item?i("div",{staticClass:"specs__container"},[i("div",{staticClass:"specs__title"},[t._v(t._s(t.item.name))]),i("div",{staticClass:"specs__details"},[i("ul",{staticClass:"specs__attrs"},[t._l(t.item.specifications,function(e,s){return i("li",{key:e.name+s,staticClass:"specs__attr"},[i("div",{staticClass:"specs__attr-title"},[t._v(t._s(e.name))]),i("ul",{staticClass:"specs__attr-options"},t._l(e.values,function(a){return i("li",{key:a,staticClass:"specs__attr-option",class:{"specs__attr-option_active":t.selectedSpecs[s]&&t.selectedSpecs[s].value===a},on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.selectSpec(s,e.name,a)}}},[t._v(t._s(a))])}))])}),t._l(t.item.attrs,function(e,s){return i("li",{key:e.name+s,staticClass:"specs__attr"},[i("div",{staticClass:"specs__attr-title"},[t._v(t._s(e.name))]),i("ul",{staticClass:"specs__attr-options"},t._l(e.values,function(a){return i("li",{key:a+s,staticClass:"specs__attr-option",class:{"specs__attr-option_active":t.selectedAttrs[s]&&t.selectedAttrs[s].value===a},on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.selectAttr(s,e.name,a)}}},[t._v(t._s(a))])}))])})],2)]),i("div",{staticClass:"specs__result"},[i("div",{staticClass:"specs__price"},[t._v(t._s(t.item.specfoods[t.selectedSpecFoodIdx].price)+"\n      ")]),i("a",{staticClass:"specs__btn-add-cart",attrs:{href:"javascript"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.ok(e)}}},[t._v("选好了")])])]):t._e()},nt=[],ot={name:"FoodSpec",components:{},props:{item:{type:Object,default:function(){return{}}}},data:function(){return{selectedAttrs:[],selectedSpecs:[],selectedSpecFoodIdx:void 0}},computed:{indexMap:function(){var t,e=this;try{t=this.item.specifications[0].values}catch(t){}var i=t.reduce(function(t,i){var s=-1;return e.item.specfoods.some(function(t,e){var a;try{a=t.specs[0].value}catch(t){}return i===a&&(s=e,!0)}),t[i]=s,t},{});return console.log("result:",i),i}},created:function(){this.init()},watch:{item:function(){this.init()}},methods:{ok:function(){this.$emit("ok",Object(o["a"])({},this.item,this.item.specfoods[this.selectedSpecFoodIdx],{attrs:this.selectedAttrs}))},selectAttr:function(t,e,i){this.selectedAttrs.splice(t,1,{name:e,value:i})},selectSpec:function(t,e,i){this.selectedSpecs.splice(t,1,{name:e,value:i}),this.selectedSpecFoodIdx=this.indexMap[i]},init:function(){var t=this.item;if(t){var e=t.attrs||[],i=t.specifications||[];this.selectedAttrs=e.map(function(t){return{name:t.name,value:t.values[0]}}),this.selectedSpecs=i.map(function(t){return{name:t.name,value:t.values[0]}}),this.selectedSpecFoodIdx=0}}}},rt=ot,ct=(i("4676"),Object(h["a"])(rt,at,nt,!1,null,"cfe51f7c",null));ct.options.__file="FoodSpec.vue";var lt=ct.exports,ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide"}},[t.visible&&t.food?i("div",{directives:[{name:"hold-up-scroll",rawName:"v-hold-up-scroll"}],staticClass:"modal__container"},[i("div",{staticClass:"modal__overlay",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.onClose(e)}}}),i("div",{staticClass:"modal__panel food-detail__container"},[i("div",{staticClass:"food-detail__img-wrap"},[i("img",{attrs:{src:t.$getImage(t.food.image_path,t.foodDetailImgParam),alt:""}})]),i("div",{staticClass:"food-detail__info"},[i("h2",{staticClass:"food-detail__name ellipsis"},[t._v(t._s(t.food.name))]),i("div",{staticClass:"food-detail__service"},[i("span",{staticClass:"food-detail__sales"},[t._v("月售"+t._s(t.food.month_sales)+"份 ")]),i("span",{staticClass:"food-detail__satisfy-rate"},[t._v("好评率"+t._s(t.food.satisfy_rate))])]),i("div",{staticClass:"food-detail__price-row"},[i("span",{staticClass:"food-detail__price"},[t._v(t._s(t.food.specfoods[0].price))]),i("cart-button",{staticClass:"food-detail__cart-btns",attrs:{item:t.food,quantity:t.quantity},on:{add:t.onAdd,reduce:t.onReduce,showspec:t.onShowSpec}})],1),i("div",{staticClass:"food-detail__description"},[t._v(t._s(t.food.description))])]),i("div",{staticClass:"modal__close-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.onClose(e)}}},[i("svg",{staticClass:"foodpanel-closeIcon_3a1DT",attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"}},[i("defs",[i("path",{attrs:{id:"a",d:"M13.132 12l6.47-6.47a.75.75 0 0 0-1.061-1.06l-6.47 6.47-6.47-6.47a.75.75 0 0 0-1.06 1.06L11.01 12l-.072.071.071.071-6.47 6.47a.75.75 0 0 0 1.061 1.06l6.47-6.47 6.47 6.47a.75.75 0 0 0 1.06-1.06l-6.47-6.47.072-.07-.071-.072z"}})]),i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("use",{attrs:{fill:"#fff","fill-rule":"nonzero","xlink:href":"#a"}}),i("path",{attrs:{d:"M0 0h24v24H0z"}})])])])])]):t._e()])},_t=[],dt={name:"FoodDetail",components:{CartButton:M},props:{visible:{type:Boolean,default:!1},food:{type:Object},quantity:{type:Number}},data:function(){return{foodDetailImgParam:"?imageMogr/format/webp/thumbnail/!375x375r/gravity/Center/crop/375x375/"}},methods:{onClose:function(){this.$emit("close")},onAdd:function(t){this.$emit("add",t)},onReduce:function(t){this.$emit("reduce",t)},onShowSpec:function(t){this.$emit("showspec",t)}}},mt=dt,vt=(i("349e"),Object(h["a"])(mt,ut,_t,!1,null,"726e1067",null));vt.options.__file="FoodDetail.vue";var pt=vt.exports,ft={name:"OrderFood",components:{Modal:l["a"],FoodMenu:Y,CartView:st,FoodSpec:lt,FoodDetail:pt},props:{shopDetails:Object,menu:Array},data:function(){return{specShow:!1,specItem:null,showingFood:null,foodDetailVisible:!1,cartClient:null}},computed:Object(o["a"])({},Object(r["e"])(["geohash","userId"]),{entities:function(){var t=this.$store.state;try{return t.cartMap[this.shopDetails.id].entities}catch(t){return[]}},selectedNums:function(){return this.entities.reduce(function(t,e){var i=e.item_id,s=e.category_id;return t.item[i]=(t.item[i]||0)+e.quantity,t.category[s]=(t.category[s]||0)+e.quantity,t},{item:{},category:{}})}}),created:function(){this.updateRemoteCart()},methods:Object(o["a"])({},Object(r["d"])(["ADD_CART","REDUCE_CART","CLEAR_CART","SAVE_CURRENT_RESTAURANT_ID"]),{addCart:function(t){this.ADD_CART(Object(o["a"])({},t,{restaurant_id:this.shopDetails.id})),this.updateRemoteCart([t.sku_id])},reduceCart:function(t){this.REDUCE_CART(Object(o["a"])({},t,{restaurant_id:this.shopDetails.id})),this.updateRemoteCart([t.sku_id])},clearCart:function(){this.CLEAR_CART({restaurant_id:this.shopDetails.id}),this.updateRemoteCart([])},updateRemoteCart:function(t){var e=this;t=t||[];var i={geohash:this.geohash,user_id:this.userId,restaurant_id:this.shopDetails.id,entities:this.entities.map(function(t){var i=e.pick(t,["id","sku_id","quantity","new_specs","attrs","specs"]);return i.new_specs=i.specs,delete i.specs,i}),sku_ids:t};Object(c["y"])(i).then(function(t){e.cartClient=t}).catch(function(t){l["d"].open({content:t.message,mask:!1})})},pick:function(t,e){return!t||"object"!==Object(A["a"])(t)&&"function"!==typeof t?t:e&&e.length?(e=Array.isArray(e)?e:[e],e.reduce(function(e,i){return i in t&&(e[i]=t[i]),e},{})):t},toCheckout:function(){this.SAVE_CURRENT_RESTAURANT_ID(this.shopDetails.id),this.$router.push("/checkout")},openSpecPanel:function(t){this.specShow=!0,this.specItem=t},closeSpecPanel:function(){this.specShow=!1,this.specItem=null},saveSpecPanel:function(t){this.addCart(t),this.closeSpecPanel()},openFoodDetail:function(t){this.showingFood=t,this.foodDetailVisible=!0},closeFoodDetail:function(){this.showingFood=null,this.foodDetailVisible=!1}})},ht=ft,gt=(i("fdac"),Object(h["a"])(ht,P,E,!1,null,"644da318",null));gt.options.__file="OrderFood.vue";var Ct=gt.exports,bt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rating__container"},[t.loading?t._e():[t.rating?s("div",{staticClass:"rating__overview"},[s("div",{staticClass:"overview__overall"},[s("div",{staticClass:"overview__overall-score"},[t._v(t._s(t._f("fixedNum")(t.rating.overall_score)))]),s("div",{staticClass:"overview__overall-text"},[t._v("综合评价")]),s("div",{staticClass:"overview__comparation"},[t._v("高于周边商家"+t._s(t._f("percentNum")(t.rating.compare_rating)))])]),s("div",{staticClass:"overview__specific"},[s("div",{staticClass:"overview__item overview__service-score"},[s("span",{staticClass:"overview__item-name"},[t._v("服务态度")]),s("span",{staticClass:"overview__item-value"},[t._v(t._s(t._f("fixedNum")(t.rating.service_score)))])]),s("div",{staticClass:"overview__item overview__food-score"},[s("span",{staticClass:"overview__item-name"},[t._v("商品评分")]),s("span",{staticClass:"overview__item-value"},[t._v(t._s(t._f("fixedNum")(t.rating.food_score)))])]),s("div",{staticClass:"overview__item overview__deliver-time"},[s("span",{staticClass:"overview__item-name"},[t._v("送达时间")]),s("span",{staticClass:"overview__deliver-time-value"},[t._v(t._s(t.rating.deliver_time)+"分钟")])])])]):t._e(),s("div",{staticClass:"rating__content"},[t.tags.length?s("ul",{staticClass:"rating__tags"},t._l(t.tags,function(e,i){return s("li",{key:String(e.name)+i,staticClass:"rating__tag",class:{tag_unsatisfied:e.unsatisfied,tag_active:e.name===t.tagNameCurrent},on:{click:function(i){t.onTabsNavTap(e.name)}}},[s("span",{staticClass:"tag__name"},[t._v(t._s(e.name))]),t._v(" \n          "),s("span",{staticClass:"tag__count"},[t._v(t._s(e.count))])])})):t._e(),t.comments.length?s("ul",{staticClass:"rating__comments"},t._l(t.comments,function(e,a){return s("li",{key:String(e.food_id)+a,staticClass:"comment"},[s("div",{staticClass:"comment__content"},[s("div",{staticClass:"comment__avatar"},[e.avatar?s("img",{attrs:{src:t.$getImage(e.avatar,t.avatarImgParam),alt:""}}):s("span",{style:{backgroundPositionY:t.$toRem(60)}})]),s("div",{staticClass:"comment__info"},[s("div",{staticClass:"comment__heading"},[s("h3",{staticClass:"comment__username"},[t._v(t._s(e.username))]),s("div",{staticClass:"comment__rated-at"},[t._v(t._s(e.rated_at))])]),s("div",[s("div",{staticClass:"comment__rating"},[s("div",{staticClass:"star"},[t._m(0,!0),s("div",{staticClass:"star__active",style:{right:(5-e.rating)/5*100+"%"}},[s("img",{attrs:{src:i("e77a"),alt:""}})])]),s("span",{staticClass:"comment__rating-start-text",style:{color:t.ratingGradeMap[e.rating][1]}},[t._v(t._s(t.ratingGradeMap[e.rating][0]))])]),s("div",{staticClass:"comment__rating-text"},[t._v(t._s(e.rating_text))]),e.reply?s("div",{staticClass:"comment__reply-content"},[t._v(t._s(e.reply&&e.reply.content))]):t._e(),s("viewer",{staticClass:"re-rating-comment__food-images",attrs:{items:t.transformForViewer(e.order_images)}}),s("div",{staticClass:"comment__food-list"},[s("svg",[s("use",{attrs:{"xlink:href":"#like"}})]),t._l(e.food_ratings,function(e,i){return s("span",{key:String(e.food_id)+i,staticClass:"comment__food ellipsis"},[t._v("\n                       "+t._s(e.rate_name)+"\n                     ")])})],2)],1)])])])})):t._e()]),s("InfiniteScroll",{ref:"infiniteScroll",attrs:{handler:t.infiniteScrollHandler}})],s("loading-image",{attrs:{visible:t.loading}})],2)},yt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"star__gray"},[s("img",{attrs:{src:i("fc5b"),alt:""}})])}],wt=i("7be6"),kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"viewer-thumbnail__container"},t._l(t.usedItems,function(e,s){return i("div",{key:s,staticClass:"viewer-thumbnail__item"},[i("img",{ref:"thumbnails",refInFor:!0,attrs:{src:e.thumbnail,alt:""},on:{click:function(e){t.onThumbnailClick(e,s)}}})])}))},xt=[],St=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"viewer__container"},[i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.transitionVisible,expression:"transitionVisible"}],staticClass:"viewer__mask",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.close(t.currentIdx)}}})]),i("div",{staticClass:"viewer__wrap"},[i("transition",{attrs:{name:"view"},on:{beforeEnter:t.beforeEnter,enter:t.enter,afterEnter:t.afterEnter,beforeLeave:t.beforeLeave,leave:t.leave,afterLeave:t.afterLeave}},[t.activeItem?i("div",{directives:[{name:"show",rawName:"v-show",value:t.transitionVisible,expression:"transitionVisible"}],staticClass:"transition-container",style:[t.rectStyle,t.transformStyle],on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.close(t.currentIdx)}}},[t.activeItem.loaded?i("img",{attrs:{src:t.activeItem.image,alt:""}}):i("img",{attrs:{src:t.activeItem.thumbnail,alt:""}})]):t._e()]),t.galleryVisible?i("div",{staticClass:"gallery__container o-image__gallery"},[i("div",{staticClass:"gallery__wrap"},t._l(t.items,function(e,s){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.galleryCurrentIdx===s,expression:"galleryCurrentIdx === idx"}],key:s,staticClass:"gallery__item"},[i("div",{staticClass:"o-image__item",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.close(t.galleryCurrentIdx)}}},[i("img",{attrs:{src:e.image,alt:""}}),i("div",{staticClass:"o-image__caption"},[t._v(t._s(e.caption))])])])}))]):t._e()],1)],1)},It=[],Dt={data:function(){return{items:[],els:[],activeItem:null,currentIdx:0,lastIdx:null,loop:!1,clickLocking:!1,transitionVisible:!1,rectStyle:null,transformStyle:null,computedStyles:null,galleryVisible:!1,galleryCurrentIdx:0}},created:function(){window.viewer=this},methods:{onThumbnailClick:function(t,e){var i=this;return this.clickLocking||this.currentIdx===e?Promise.resolve():(this.clickLocking=!0,this.lastIdx=this.currentIdx,this.currentIdx=e,Promise.resolve().then(function(){return i.close(i.lastIdx)}).then(function(){return i.open(i.currentIdx)}).then(function(){i.clickLocking=!1}))},getThumbnailElByIdx:function(t){return this.els[t]},fixIdx:function(t){var e=this.items.length;if(t>=0&&t<e)return t;if(!this.loop)return null;var i=t%4;return i>=0?i:e+i},fixEl:function(t,e){return t instanceof HTMLElement?t:this.getThumbnailElByIdx(e)},open:function(t,e){var i=this;if(this.transitionVisible)return Promise.resolve();if(t=this.fixIdx(t),e=this.fixEl(e,t),null==t)return Promise.reject("idx should not be null");if(null==e)return Promise.reject("el should not be null");var s=this.items[t];return s.loaded||this.loadImage(s.image).then(function(){s.loaded=!0}),new Promise(function(s){i.activeItem=i.items[t],i.computedStyles=i.computeTransitionStyle(e),i.$on("afterEnter",s),i.transitionVisible=!0}).then(function(){i.galleryCurrentIdx=t,i.galleryVisible=!0})},close:function(t,e){var i=this;return this.transitionVisible?(t=this.fixIdx(t),e=this.fixEl(e,t),null==t?Promise.reject("idx should not be null"):null==e?Promise.reject("el should not be null"):new Promise(function(s){i.activeItem=i.items[t],i.computedStyles=i.computeTransitionStyle(e),i.$on("afterLeave",s),i.transitionVisible=!1,i.galleryVisible=!1})):Promise.resolve()},beforeEnter:function(t){var e=this,i=this.computedStyles,s=i.rectStyle,a=i.transformStyle;this.rectStyle=s,this.transformStyle=null,requestAnimationFrame(function(){requestAnimationFrame(function(){t.style.transition="all .3s",e.transformStyle=a})})},enter:function(t,e){t.addEventListener("transitionend",e)},afterEnter:function(t){t.style.transition="",this.rectStyle=null,this.transformStyle=null,this.$emit("afterEnter")},beforeLeave:function(t){var e=this,i=this.computedStyles,s=i.rectStyle,a=i.transformStyle;this.rectStyle=s,this.transformStyle=a,requestAnimationFrame(function(){requestAnimationFrame(function(){t.style.transition="all .3s",e.transformStyle=null})})},leave:function(t,e){t.addEventListener("transitionend",e)},afterLeave:function(t){t.style.transition="",this.rectStyle=null,this.transformStyle=null,this.$emit("afterLeave")},loadImage:function(t){return new Promise(function(e,i){var s=new Image;s.addEventListener("load",e),s.addEventListener("error",i),s.src=t})},getElementRect:function(t){var e=t.getBoundingClientRect(),i=e.width,s=e.height,a=e.top,n=e.left;return{width:i,height:s,left:n,top:a,centerX:n+i/2,centerY:a+s/2}},getViewportRect:function(){var t=window.innerWidth,e=window.innerHeight;return{width:t,height:e,centerX:t/2,centerY:e/2}},computeTransitionStyle:function(t){var e=this.getElementRect(t),i=this.getViewportRect(),s=i.centerX-e.centerX,a=i.centerY-e.centerY,n=i.width/e.width,o={width:e.width+"px",height:e.height+"px",top:e.top+"px",left:e.left+"px"},r={transform:"translate(".concat(s,"px, ").concat(a,"px) scale(").concat(n,")")};return{rectStyle:o,transformStyle:r}}}},$t=Dt,jt=(i("03af"),Object(h["a"])($t,St,It,!1,null,"d4adbbfe",null));jt.options.__file="ViewerModal.vue";var Pt,Et=jt.exports,At=!1,Ft={name:"Viewer",components:{},props:{items:{type:Array,required:!0},thumbnailIndex:{type:[String,Number,Array]}},data:function(){return{clickLocking:!1}},computed:{modal:function(){return Pt},usedItems:function(){var t=this;if(!this.thumbnailIndex)return this.items;if(Array.isArray(this.thumbnailIndex)){var e=this.items.length;return this.thumbnailIndex.reduce(function(i,s){return s>=0&&s<e&&i.push(t.items[s]),i},[])}return[this.items[this.thumbnailIndex]]}},mounted:function(){At||(console.log("[viewer] mounted"),At=!0,Pt=new(V["a"].extend(Et)),Pt.$mount(),document.body.appendChild(Pt.$el))},beforeDestroy:function(){At&&(console.log("[viewer] beforeDestroy"),At=!1,document.body.removeChild(Pt.$el),Pt=null)},methods:{open:function(t){this.modal.items=this.items,this.modal.els=this.$refs["thumbnails"],this.modal.open(t)},close:function(t){this.modal.close(t)},onThumbnailClick:function(t,e){var i=this;return this.clickLocking?Promise.resolve():(this.clickLocking=!0,Promise.resolve().then(function(){return i.open(e)}).then(function(){i.clickLocking=!1}))}}},Ot=Ft,Nt=(i("6f57"),Object(h["a"])(Ot,kt,xt,!1,null,null,null));Nt.options.__file="Viewer.vue";var Rt=Nt.exports,Lt=i("854e"),qt=!1,Tt={props:{restaurantId:{type:[Number,String]}},components:{LoadingImage:wt["a"],Viewer:Rt,InfiniteScroll:Lt["default"]},data:function(){return{loading:!1,rating:null,tags:[],comments:[],limit:20,offset:0,tagNameCurrent:"",avatarImgParam:"?imageMogr/format/webp/thumbnail/!60x60r/gravity/Center/crop/60x60/",commentImgParam:"?imageMogr/format/webp/thumbnail/300x/",commentBigImgParam:"?imageMogr/format/webp/thumbnail/750x/",ratingGradeMap:{1:["吐槽","rgb(137, 159, 188)"],2:["较差","rgb(137, 159, 188)"],3:["一般","rgb(251, 154, 11)"],4:["满意","rgb(251, 154, 11)"],5:["超赞","rgb(255, 96, 0)"]}}},created:function(){this.loadOverview()},methods:{loadOverview:function(){var t=this;this.loading=!0,Object(c["c"])({restaurantId:this.restaurantId,has_content:!0}).then(function(e){t.comments=e.comments,t.offset=t.comments.length,t.rating=e.rating,t.tags=e.tags,t.tagNameCurrent=e.tags[0].name,t.loading=!1})},onTabsNavTap:function(t){var e=this;this.tagNameCurrent!==t&&(this.tagNameCurrent=t,this.offset=0,this.comments=[],this.$nextTick(function(){e.$refs.infiniteScroll.reset()}))},infiniteScrollHandler:function(t){qt&&console.log("debug - exec infiniteScrollHandler"),this.loadComments().then(function(e){console.log("debug - infinite scroll loaded"),t(e)})},loadComments:function(){var t=this;qt&&console.log("debug - exec loadComments");var e=this.restaurantId,i=this.tagNameCurrent,s=this.offset;return Object(c["o"])({restaurantId:e,has_content:!0,tag_name:i,offset:s}).then(function(e){var i;return qt&&console.log("debug - get response of comments"),t.comments=0===s?e:t.comments.concat(e),t.offset=t.comments.length,i=t.offset?e.length?"loaded":"complete":"empty",i}).catch(function(){return"loaded"})},transformForViewer:function(t){var e=this;return(t||[]).map(function(t){return{thumbnail:e.$getImage(t.image_hash,e.commentImgParam),image:e.$getImage(t.image_hash,e.commentBigImgParam),caption:t.food_names[0],loaded:!1}})}},filters:{fixedNum:function(t){return void 0!==t?t.toFixed(1):t},percentNum:function(t){return(100*t).toFixed(1)+"%"}}},Mt=Tt,Vt=(i("c36a"),i("3f45"),Object(h["a"])(Mt,bt,yt,!1,null,"21ffd646",null));Vt.options.__file="Rating.vue";var Bt=Vt.exports,Ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"seller__container"},[i("div",{staticClass:"seller__item"},[t._m(0),i("div",{staticClass:"seller__item-content deliver-info"},[i("p",[1===t.shopDetails.delivery_mode.id?i("tag",{staticClass:"deliver-info__mode",style:{fontSize:t.$toRem(22),backgroundColor:"#"+t.shopDetails.delivery_mode.color}},[t._v(t._s(t.shopDetails.delivery_mode.text))]):i("span",[t._v(t._s(t.shopDetails.delivery_mode.text))]),i("span",[t._v("约"+t._s(t.shopDetails.order_lead_time)+"分钟送达，")]),i("span",[t._v("距离"+t._s(t.shopDetails.distance)+"m")])],1),i("p",[i("span",[t._v("配送费 ¥ "+t._s(t.shopDetails.piecewise_agent_fee.rules[0].fee))])])])]),t.shopDetails.activities&&t.shopDetails.activities.length?i("div",{staticClass:"seller__item"},[t._m(1),i("div",{staticClass:"seller__item-content activity"},t._l(t.shopDetails.activities,function(e){return i("div",{key:e.id,staticClass:"activity__item"},[i("tag",{staticClass:"activity__icon",style:{fontSize:t.$toRem(24),backgroundColor:"#"+e.icon_color},attrs:{text:"文本"}},[t._v(t._s(e.icon_name))]),i("span",[t._v(t._s(e.tips))])],1)}))]):t._e(),t.shopDetails.albums&&t.shopDetails.albums.length?i("div",{staticClass:"seller__item"},[t._m(2),i("div",{staticClass:"album__content"},t._l(t.shopDetails.albums,function(e,s){return i("a",{key:e.name+s,staticClass:"album__item",attrs:{href:"javascript:"}},[i("viewer",{attrs:{items:t.transformForViewer(e.photos),thumbnailIndex:"0"}}),i("span",{staticClass:"album__name"},[t._v(t._s(e.name)+"("+t._s(e.count)+"张)")])],1)}))]):t._e(),i("div",{staticClass:"seller__item"},[t._m(3),i("div",[i("ul",[i("li",{staticClass:"info__item"},[t._v(t._s(t.shopDetails.description||"暂无简介"))]),i("li",{staticClass:"info__item"},[i("span",{staticClass:"info__item-name"},[t._v("品类")]),i("span",[t._v(t._s(t.shopDetails.flavors.map(function(t){return t.name}).join(", ")))])]),i("li",{staticClass:"info__item"},[i("span",{staticClass:"info__item-name"},[t._v("商家电话")]),i("span",[t._v(t._s(t.shopDetails.phone.split(/\s+/)[0])+"\n            "),i("span",{staticClass:"detail-icon"})])]),i("li",{staticClass:"info__item"},[i("span",{staticClass:"info__item-name"},[t._v("地址")]),i("span",[t._v(t._s(t.shopDetails.address))])]),i("li",{staticClass:"info__item"},[i("span",{staticClass:"info__item-name"},[t._v("营业时间")]),i("span",[t._v(t._s(t.shopDetails.opening_hours.map(function(t){return t.split("/").join("-")}).join(", ")))])])])])]),t._m(4)])},zt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"seller__item-head"},[i("span",[t._v("配送信息")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"seller__item-head"},[i("span",[t._v("活动与服务")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"seller__item-head"},[i("span",[t._v("商家实景")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"seller__item-head"},[i("span",[t._v("商家信息")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"seller__item"},[i("div",{staticClass:"seller__item-head qulification"},[i("span",[t._v("营业资质")]),i("span",{staticClass:"detail-icon"})])])}],Yt={components:{Tag:l["c"],Viewer:Rt},props:{shopDetails:{type:Object,default:function(){return{}}}},data:function(){return{albumImgParam:"?imageMogr/format/webp/thumbnail/!200x200r/gravity/Center/crop/200x200/",albumBigImgParam:"?imageMogr/format/webp/thumbnail/!750x750r/gravity/Center/crop/750x750/"}},methods:{transformForViewer:function(t){var e=this;return(t||[]).map(function(t){return{thumbnail:e.$getImage(t.image_hash,e.albumImgParam),image:e.$getImage(t.image_hash,e.albumBigImgParam),loaded:!1}})}}},Ut=Yt,Gt=(i("9de1"),Object(h["a"])(Ut,Ht,zt,!1,null,"16305976",null));Gt.options.__file="Seller.vue";var Xt=Gt.exports,Jt=!0,Wt={name:"Shop",components:{Tabs:l["b"],ShopHeader:j,OrderFood:Ct,Rating:Bt,Seller:Xt,ShopSkeleton:u["a"]},data:function(){return{loading:!1,shopDetails:null,menu:null,tabs:[{key:"order-food",title:"点餐",props:["shopDetails","menu"]},{key:"rating",title:"评价",props:["restaurantId"]},{key:"seller",title:"商家",props:["shopDetails"]}]}},computed:Object(o["a"])({propsMap:function(){var t=this;return this.tabs.reduce(function(e,i){return Object(o["a"])({},e,Object(n["a"])({},i.key,(i.props||[]).reduce(function(e,i){return Object(o["a"])({},e,Object(n["a"])({},i,t[i]))},{})))},{})}},Object(r["e"])(["userId","latitude","longitude"]),{restaurantId:function(){return this.$route.query.id}}),created:function(){Jt&&(window[this.$options.name]=this),this.loadData().then(function(){window.scrollTo(0,0)})},methods:Object(o["a"])({loadData:function(){var t=this;this.loading=!0;var e={latitude:this.latitude,longitude:this.longitude};return this.reverseGeoCoding(e).then(function(t){return t},function(t){return t}).then(function(){return Object(c["e"])(Object(o["a"])({},e,{user_id:t.userId,restaurantId:t.restaurantId}))}).then(function(e){var i=e.rst,s=e.menu;return t.shopDetails=i,t.menu=s,new Promise(function(t){return setTimeout(t,500)}).then(function(){t.loading=!1,t.$emit("loaded")})},function(e){t.loading=!1,t.$emit("error",e)})}},Object(r["b"])(["reverseGeoCoding"]))},Kt=Wt,Qt=(i("323a"),Object(h["a"])(Kt,s,a,!1,null,"109649ed",null));Qt.options.__file="Shop.vue";e["default"]=Qt.exports},"854e":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"infinite",staticClass:"infinite-scroll"},[i("div",{staticClass:"infinite-scroll__trigger"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.triggerBarVisible,expression:"triggerBarVisible"}],staticClass:"infinite-scroll__loading"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.loaded,expression:"!loaded"}],staticClass:"infinite-scroll__loading-default"},[t._m(0)])]),t.complete?i("div",{staticClass:"infinite-scroll__completed"},[t._v("没有更多了哦~")]):t._e()])])},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sk-fading-circle"},[i("div",{staticClass:"sk-circle1 sk-circle"}),i("div",{staticClass:"sk-circle2 sk-circle"}),i("div",{staticClass:"sk-circle3 sk-circle"}),i("div",{staticClass:"sk-circle4 sk-circle"}),i("div",{staticClass:"sk-circle5 sk-circle"}),i("div",{staticClass:"sk-circle6 sk-circle"}),i("div",{staticClass:"sk-circle7 sk-circle"}),i("div",{staticClass:"sk-circle8 sk-circle"}),i("div",{staticClass:"sk-circle9 sk-circle"}),i("div",{staticClass:"sk-circle10 sk-circle"}),i("div",{staticClass:"sk-circle11 sk-circle"}),i("div",{staticClass:"sk-circle12 sk-circle"})])}],n=(i("cadf"),i("551c"),i("097d"),!1),o={name:"InfiniteScroll",components:{},props:{handler:{type:Function},state:{type:String}},data:function(){return{loaded:!0,complete:!1,empty:!1,elBottom:null,vpBottom:null,touched:!1}},computed:{triggerBarVisible:function(){return!this.complete||!this.empty}},watch:{state:function(t,e){t!==e&&this.setState(t)}},created:function(){window.addEventListener("scroll",this.scrollHandler),window.addEventListener("resize",this.scrollHandler),this.setState(this.state)},activated:function(){},deactivated:function(){},destroyed:function(){window.removeEventListener("scroll",this.scrollHandler),window.addEventListener("resize",this.scrollHandler)},methods:{scrollHandler:function(){var t=this;if(this.loaded&&!this.complete&&!this.empty){var e=this.$refs.infinite,i=e.getBoundingClientRect(),s=Math.round(i.bottom),a=window.innerHeight,o=s-a<=50;this.elBottom=s,this.vpBottom=a,this.touched=o,n&&console.log("<InfiniteScroll> shouldHandle"),o&&this.handler&&(this.$emit("infinite"),n&&console.log("<InfiniteScroll> trigger infinite"),this.setState("loading"),this.handler(function(e){t.setState(e)}))}},reset:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loaded=!0,this.complete=!1,this.empty=!1,t&&this.scrollHandler()},setState:function(t){"loading"===t?(this.loaded=!1,this.complete=!1,this.empty=!1):"loaded"===t?(this.loaded=!0,this.complete=!1,this.empty=!1,this.$emit("loaded")):"complete"===t?(this.loaded=!0,this.complete=!0,this.empty=!1,this.$emit("complete")):"empty"===t&&(this.loaded=!0,this.complete=!1,this.empty=!0,this.$emit("empty"))}}},r=o,c=(i("43be"),i("2e90"),i("2877")),l=Object(c["a"])(r,s,a,!1,null,"28764ee4",null);l.options.__file="InfiniteScroll.vue";var u=l.exports;i.d(e,"default",function(){return u})},"862c":function(t,e,i){"use strict";var s=i("bb04"),a=i.n(s);a.a},"91e5":function(t,e,i){},"93f6":function(t,e,i){},9499:function(t,e,i){},"9ca5":function(t,e,i){"use strict";var s=i("4b33"),a=i.n(s);a.a},"9de1":function(t,e,i){"use strict";var s=i("fefc"),a=i.n(s);a.a},"9f8f":function(t,e,i){},a7d4:function(t,e,i){},a7da:function(t,e,i){"use strict";var s=i("91e5"),a=i.n(s);a.a},b089:function(t,e,i){},bb04:function(t,e,i){},c36a:function(t,e,i){"use strict";var s=i("08b7"),a=i.n(s);a.a},d1b4:function(t,e,i){},e77a:function(t,e,i){t.exports=i.p+"img/stars-active.77db2273.svg"},f789:function(t,e,i){},fc5b:function(t,e,i){t.exports=i.p+"img/stars-gray.b7cbf04a.svg"},fcd7:function(t,e,i){"use strict";var s=i("4c13"),a=i.n(s);a.a},fdac:function(t,e,i){"use strict";var s=i("f789"),a=i.n(s);a.a},fefc:function(t,e,i){}}]);
//# sourceMappingURL=Shop.4f645312.js.map