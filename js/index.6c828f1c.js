(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["index"],{"0560":function(t,e,s){},"0c2a":function(t,e,s){"use strict";var i=s("0d2e"),a=s.n(i);a.a},"0d2e":function(t,e,s){},"2fdb":function(t,e,s){"use strict";var i=s("5ca1"),a=s("d2c8"),n="includes";i(i.P+i.F*s("5147")(n),"String",{includes:function(t){return!!~a(this,t,n).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},3506:function(t,e,s){"use strict";var i=s("0560"),a=s.n(i);a.a},5147:function(t,e,s){var i=s("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(s){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},"5acf":function(t,e,s){},6762:function(t,e,s){"use strict";var i=s("5ca1"),a=s("c366")(!0);i(i.P,"Array",{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),s("9c6c")("includes")},"6cdb":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("page",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"p-select-address p-select-address__box",attrs:{title:"选择收货地址","back-default":!1},on:{back:t.onBack}},[s("div",{staticClass:"p-select-address__search-bar"},[s("div",{staticClass:"p-select-address__city-btn",on:{click:t.chooseCity}},[s("span",{staticClass:"p-select-address__city-name ellipsis"},[t._v(t._s(t.cityName))]),s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 14 8"}},[s("path",{attrs:{fill:"#333","fill-rule":"evenodd",d:"M5.588 6.588c.78.78 2.04.784 2.824 0l5.176-5.176c.78-.78.517-1.412-.582-1.412H.994C-.107 0-.372.628.412 1.412l5.176 5.176z"}})])]),s("div",{staticClass:"p-select-address__search-box"},[s("svg",{staticClass:"p-select-address__search-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"}},[s("path",{attrs:{"fill-opacity":".38",d:"M14.778 13.732a.739.739 0 1 1-1.056 1.036l-2.515-2.565a.864.864 0 0 1-.01-1.206 4.894 4.894 0 0 0 1.357-3.651c-.126-2.492-2.156-4.52-4.648-4.647a4.911 4.911 0 0 0-5.16 5.163c.126 2.475 2.13 4.496 4.605 4.642.451.026.896-.008 1.326-.1a.739.739 0 0 1 .308 1.446c-.56.12-1.137.164-1.72.13-3.227-.19-5.83-2.815-5.995-6.042a6.39 6.39 0 0 1 6.71-6.715c3.25.165 5.884 2.8 6.05 6.048a6.37 6.37 0 0 1-1.374 4.3l2.12 2.161z"}})]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],ref:"input",staticClass:"p-select-address__input",attrs:{type:"search",placeholder:"请输入地址"},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}})])]),s("section",{directives:[{name:"show",rawName:"v-show",value:!t.resultListVisible,expression:"!resultListVisible"}],staticClass:"p-select-address__section"},[s("h4",[t._v("当前地址")]),s("div",{staticClass:"p-select-address__current",on:{click:t.onBack}},[s("span",{staticClass:"ellipsis"},[t._v(t._s(t.locationName||"未知地址"))]),s("span",{staticClass:"p-select-address__relocate",on:{click:function(e){return e.stopPropagation(),t.reLocate(e)}}},[s("svg",{class:{"p-select-address__reloading":t.reloading},attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 15 15"}},[s("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[s("circle",{attrs:{cx:"7.5",cy:"7.5",r:"7",stroke:"#2395FF"}}),s("path",{attrs:{fill:"#2395FF",d:"M7 0h1v5H7zM7 10h1v5H7zM10 7h5v1h-5zM0 7h5v1H0z"}})])]),s("span",[t._v("重新定位")])])])]),s("section",{directives:[{name:"show",rawName:"v-show",value:t.addressListVisible,expression:"addressListVisible"}],staticClass:"p-select-address__section"},[s("h4",[t._v("收货地址")]),s("div",{staticClass:"p-select-address__address-list"},t._l(t.addressList,function(e){return s("div",{key:e.id,staticClass:"p-select-address__address-item",on:{click:function(s){t.select(e)}}},[s("div",{staticClass:"p-select-address__address-line"},[s("span",{staticClass:"p-select-address__address-name"},[t._v(t._s(e.name))]),s("span",{staticClass:"p-select-address__address-sex"},[t._v(t._s(["先生","女士"][e.sex-1]))]),s("span",[t._v(t._s(e.phone))])]),s("div",{staticClass:"p-select-address__address-address"},[s("span",[t._v(t._s(e.address))])])])}))]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.resultListVisible,expression:"resultListVisible"}],staticClass:"p-select-address__result-list"},[t._l(t.results,function(e){return s("div",{key:e.id,staticClass:"p-select-address__result-item",on:{click:function(s){t.select(e)}}},[s("div",{staticClass:"p-select-address__result-info"},[s("div",{staticClass:"p-select-address__result-name"},[t._v(t._s(e.name))]),s("div",{staticClass:"p-select-address__result-address"},[t._v(t._s(e.address))])]),s("div",{staticClass:"p-select-address__result-distance"},[t._v(t._s(e.distance))])])}),s("div",{staticClass:"p-select-address__result-tip"},[s("p",[t._v("找不到地址？")]),s("p",[t._v("请尝试只输入小区、写字楼或学校名")]),s("p",[t._v("详细地址（如门牌号）可稍后输入")])])],2),s("SelectCity",{directives:[{name:"show",rawName:"v-show",value:t.selectCityVisible,expression:"selectCityVisible"}],staticClass:"p-select-address__select-city",attrs:{"city-data":t.cityList,"default-name":t.cityName},on:{change:t.onChangeCity,back:function(e){t.selectCityVisible=!1}}})],1)},a=[],n=(s("7f7f"),s("386d"),s("a481"),s("c93e")),c=(s("cadf"),s("551c"),s("097d"),s("2f62")),r=s("408b"),l=s("9973"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("page",{staticClass:"b-select-city b-select-city__box",attrs:{title:"城市选择"},on:{back:t.onBack}},[s("section",{staticClass:"b-select-city__search"},[s("svg",{staticClass:"b-select-city__search-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"}},[s("path",{attrs:{"fill-opacity":".38",d:"M14.778 13.732a.739.739 0 1 1-1.056 1.036l-2.515-2.565a.864.864 0 0 1-.01-1.206 4.894 4.894 0 0 0 1.357-3.651c-.126-2.492-2.156-4.52-4.648-4.647a4.911 4.911 0 0 0-5.16 5.163c.126 2.475 2.13 4.496 4.605 4.642.451.026.896-.008 1.326-.1a.739.739 0 0 1 .308 1.446c-.56.12-1.137.164-1.72.13-3.227-.19-5.83-2.815-5.995-6.042a6.39 6.39 0 0 1 6.71-6.715c3.25.165 5.884 2.8 6.05 6.048a6.37 6.37 0 0 1-1.374 4.3l2.12 2.161z"}})]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"b-select-city__input",attrs:{type:"search",placeholder:"输入城市名、拼音或首字母查询"},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}})]),t.cityData?[s("section",{directives:[{name:"show",rawName:"v-show",value:!t.query,expression:"!query"}],ref:"city",staticClass:"b-select-city__content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.cityName,expression:"cityName"}],staticClass:"b-select-city__section"},[s("h2",{staticClass:"b-select-city__section-title"},[t._v("当前定位城市")]),s("div",{staticClass:"b-select-city__city-item"},[t._v(t._s(t.cityName))])]),t._l(t.cityData.cityList,function(e){return s("div",{key:e.idx,staticClass:"b-select-city__section",attrs:{id:e.idx}},[s("h2",{staticClass:"b-select-city__section-title"},[t._v(t._s(e.idx))]),t._l(e.cities,function(e){return s("div",{key:e.id,staticClass:"b-select-city__city-item"},[s("span",{on:{click:function(s){t.onSelectCity(e)}}},[t._v(t._s(e.name))])])})],2)}),s("aside",{staticClass:"b-select-city__sidebar"},t._l(t.cityData.alphabet,function(e){return s("span",{key:e,on:{click:function(s){t.jump(e)}}},[t._v(t._s(e))])}))],2)]:t._e(),s("section",{directives:[{name:"show",rawName:"v-show",value:t.query&&t.results.length,expression:"query && results.length"}],staticClass:"b-select-city__search-result"},t._l(t.results,function(e){return s("div",{key:e.id,staticClass:"b-select-city__city-item"},[s("span",{on:{click:function(s){t.onSelectCity(e)}}},[t._v(t._s(e.name))])])})),s("section",{directives:[{name:"show",rawName:"v-show",value:t.query&&!t.results.length,expression:"query && !results.length"}],staticClass:"b-select-city__no-result"},[s("span",[t._v("无结果")])])],2)},d=[],u=(s("6762"),s("2fdb"),s("8afe")),h=!1,_={name:"SelectCity",components:{Page:l["a"]},props:{defaultName:{type:String},cityData:{type:Object}},data:function(){return{query:"",currentCity:{},results:[]}},computed:{flatCityList:function(){return this.cityData.cityList.reduce(function(t,e){return Object(u["a"])(t).concat(Object(u["a"])(e.cities))},[])},cityName:function(){return this.currentCity&&this.currentCity.name||this.defaultName}},created:function(){h&&(window[this.$options.name]=this)},watch:{query:function(t){t&&(this.results=this.flatCityList.filter(function(e){return e.name.includes(t)||e.pinyin.includes(t.toLowerCase())}))}},methods:{onSelectCity:function(t){this.query="",this.currentCity.id!==t.id&&(this.currentCity=t,this.$emit("change",t)),this.onBack()},jump:function(t){var e=document.getElementById(t);if(e.scrollIntoView)return e.scrollIntoView();var s=this.$refs.city,i=s.getBoundingClientRect(),a=e.getBoundingClientRect();s.scrollTop+=a.top-i.top},onBack:function(){this.$emit("back")}}},p=_,v=(s("8089"),s("2877")),f=Object(v["a"])(p,o,d,!1,null,"61b889a8",null);f.options.__file="SelectCity.vue";var g=f.exports,y=s.e("Geohash").then(s.t.bind(null,"e02a",7)).then(function(t){y=t}),m=!0,b={name:"SelectAddress",components:{Page:l["a"],SelectCity:g},props:{visible:{type:Boolean,default:!1}},data:function(){return{query:"",addressList:[],results:[],loaded:!1,reloading:!1,emptyTip:{img:"no-log",title:"没有搜索结果",content:"换个关键字试试"},geohashChanged:!1,selectCityVisible:!1}},computed:Object(n["a"])({},Object(c["e"])(["useId","longitude","latitude","locationName","cityList"]),{resultListVisible:function(){return this.query&&this.results.length},addressListVisible:function(){return!this.resultListVisible&&this.addressList.length},cityName:function(){return(this.$store.state.cityName||"").replace(/市$/,"")||"选择..."}}),watch:{query:function(t,e){m&&console.log("query:",t),t&&t!==e&&this.search(t),t||(this.results=[])},visible:function(t,e){t&&t!==e&&(this.geohashChanged=!1,this.reverseGeoCoding())}},created:function(){m&&(window[this.$options.name]=this),this.fetchAddressList()},methods:Object(n["a"])({fetchAddressList:function(){var t=this;return this.loaded=!1,Object(r["a"])().then(function(e){t.addressList=e.filter(function(t){if(0===t.poi_type&&"0"!==t.st_geohash)return t.geohash=t.st_geohash,!0}),t.loaded=!0,t.addressList.length||t.$refs.input.focus()})},search:function(t){var e=this;t&&Object(r["t"])({keyword:t,latitude:this.latitude,longitude:this.longitude}).then(function(t){e.results=t})},select:function(t){if(!t)throw new TypeError("select() expect an object as argument but got undefeind");if(this.geohashChanged=!0,this.query="",!t.latitude||!t.longitude){var e=y.decode(t.geohash);t=Object(n["a"])({},t,{latitude:e.latitude,longitude:e.longitude}),m&&console.log("parse geohash to:",e)}this.$store.commit("SET_CITY_NAME",t.city||""),this.$store.commit("SET_LOCATION_NAME",t.address),this.$store.commit("SAVE_LOCATION",{latitude:t.latitude,longitude:t.longitude,geohash:t.geohash}),this.onBack()},reLocate:function(){var t=this;return this.reloading=!0,this.getCurrentPosition().then(function(e){var s=e.coords;return t.reverseGeoCoding(s)}).then(function(e){var s=e.name;t.geohashChanged=!0,t.$store.commit("SET_LOCATION_NAME",s||"未知地址")}).then(function(){t.reloading=!1},function(){t.reloading=!1})},onChangeCity:function(t){var e=this;this.geohashChanged=!0,this.$store.commit("SET_CITY_NAME",t.name),this.reverseGeoCoding({latitude:t.latitude,longitude:t.longitude}).then(function(t){var s=t.name;e.$store.commit("SET_LOCATION_NAME",s||"未知地址")}).catch(function(){e.$store.commit("SAVE_LOCATION",{latitude:t.latitude,longitude:t.longitude,geohash:y.encode(t.latitude,t.longitude,12)})}),this.query&&this.search(this.query),this.selectCityVisible=!1},chooseCity:function(){this.getCityList(),this.selectCityVisible=!0},onBack:function(){this.geohashChanged&&this.$emit("change"),this.$emit("back")}},Object(c["b"])(["getCityList","getCurrentPosition","reverseGeoCoding"]))},C=b,w=(s("dea5"),Object(v["a"])(C,i,a,!1,null,"06862f25",null));w.options.__file="SelectAddress.vue";var k=w.exports;s.d(e,"default",function(){return k})},"7be6":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"load-fade"}},[t.visible?s("div",{staticClass:"loading__wrapper"},[s("div",{staticClass:"loading__main"},[s("div",{staticClass:"loading__icon"})])]):t._e()])},a=[],n={props:{visible:{type:Boolean,default:!1}},data:function(){return{localVisible:!1}},watch:{visible:function(t){var e=this;requestAnimationFrame(function(){e.localVisible=t})}}},c=n,r=(s("b6ca"),s("2877")),l=Object(r["a"])(c,i,a,!1,null,"3b66a32e",null);l.options.__file="LoadingImage.vue";var o=l.exports;s.d(e,"a",function(){return o})},8089:function(t,e,s){"use strict";var i=s("e7a0"),a=s.n(i);a.a},9973:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page__container"},[s("page-header",{attrs:{title:t.title,"back-btn":t.backBtn},on:{back:t.onBack}}),s("div",{staticClass:"page__main"},[t._t("default")],2),s("loading-image",{attrs:{visible:t.loading}})],1)},a=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{staticClass:"page-header"},[t.backBtn?i("span",{staticClass:"page-header__left",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.onBack(e)}}},[i("img",{attrs:{src:s("c94c"),alt:""}})]):t._e(),i("h1",{staticClass:"page-header__title ellipsis"},[t._v(t._s(t.title))])])},c=[],r={name:"PageHeader",components:{},props:{title:{type:String},backBtn:{type:Boolean,default:!0}},data:function(){return{}},methods:{onBack:function(){this.$emit("back")}}},l=r,o=(s("0c2a"),s("2877")),d=Object(o["a"])(l,n,c,!1,null,"7a1ab779",null);d.options.__file="PageHeader.vue";var u=d.exports,h=s("7be6"),_={name:"Page",components:{PageHeader:u,LoadingImage:h["a"]},props:{title:{type:String},backBtn:{type:Boolean,default:!0},backDefault:{type:Boolean,default:!0},loading:{type:Boolean,default:!1}},data:function(){return{}},methods:{onBack:function(){this.$emit("back"),this.backDefault&&this.$router.back()}}},p=_,v=(s("3506"),Object(o["a"])(p,i,a,!1,null,"58972422",null));v.options.__file="Page.vue";e["a"]=v.exports},a481:function(t,e,s){s("214f")("replace",2,function(t,e,s){return[function(i,a){"use strict";var n=t(this),c=void 0==i?void 0:i[e];return void 0!==c?c.call(i,n,a):s.call(String(n),i,a)},s]})},b6ca:function(t,e,s){"use strict";var i=s("5acf"),a=s.n(i);a.a},c76b:function(t,e,s){},c94c:function(t,e,s){t.exports=s.p+"img/arrow-left.267c91c0.svg"},d2c8:function(t,e,s){var i=s("aae3"),a=s("be13");t.exports=function(t,e,s){if(i(e))throw TypeError("String#"+s+" doesn't accept regex!");return String(a(t))}},dea5:function(t,e,s){"use strict";var i=s("c76b"),a=s.n(i);a.a},e7a0:function(t,e,s){}}]);
//# sourceMappingURL=index.6c828f1c.js.map