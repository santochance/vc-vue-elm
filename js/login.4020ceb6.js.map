{"version":3,"sources":["webpack:///./src/views/Login/Login.vue?6197","webpack:///./src/views/Login/Login.vue?8191","webpack:///src/views/Login/Login.vue","webpack:///./src/views/Login/Login.vue?8567","webpack:///./src/views/Login/Login.vue","webpack:///./src/views/Login/error.png"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_style_resources_loader_lib_index_js_ref_8_oneOf_1_4_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Login_vue_vue_type_style_index_0_id_d548d02e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","xlink:href","_m","directives","name","rawName","value","phoneItem","expression","required","regex","type","maxlength","placeholder","domProps","on","input","$event","target","composing","$set","disabled","countButtonDisabled","click","stopPropagation","preventDefault","onCountClick","_v","_s","countTimeout","countValue","countButtonDirty","codeItem","to","onLogin","tag","visible","captchaShow","closable","close","captchaValue","src","captchaImage","alt","onRequestCaptcha","__webpack_require__","_e","onSubmitCaptcha","staticRenderFns","href","vue_runtime_esm","use","vee_validate_esm","debug","console","warn","Loginvue_type_script_lang_js_","components","Modal","common","props","data","captchaError","captchaHash","validateToken","errorMsgs","phone","code","watch","phoneItem.value","length","created","window","$options","methods","Object","objectSpread","fetchMobileCode","payload","mobile","captcha_hash","captcha_value","api","then","fetchMobileCodeFulfilled","catch","fetchMobileCodeRejected","fetchCaptcha","captcha_str","fetchCaptchaFulfilled","vuex_esm","setCount","_this","$validator","validate","valid","validate_code","validate_token","loginByMobile","loginByMobileFulfilled","loginByMobileRejected","error","errors","items","msg","field","rule","open","content","mask","_ref","_ref2","message","_ref3","captcha_image","redirect","_ref4","duration","$router","replace","$route","query","_this2","step","setTimeout","cancelCount","clearTimeout","Login_Loginvue_type_script_lang_js_","component","componentNormalizer","options","__file","Login","module","exports"],"mappings":"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","file":"js/login.4020ceb6.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=d548d02e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--8-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=d548d02e&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"b-login__block\"},[_c('div',{staticClass:\"b-login__wrap\"},[_c('header',{staticClass:\"b-login__header\"},[_c('div',{staticClass:\"b-login__logo\"},[_c('svg',[_c('use',{attrs:{\"xlink:href\":\"#logo\"}})])]),_vm._m(0)]),_c('div',{staticClass:\"b-login__content\"},[_c('form',[_c('div',{staticClass:\"b-login__form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.phoneItem.value),expression:\"phoneItem.value\"},{name:\"validate\",rawName:\"v-validate\",value:({ required: true, regex: /^1\\d{10}$/ }),expression:\"{ required: true, regex: /^1\\\\d{10}$/ }\"}],staticClass:\"b-login__form-control\",attrs:{\"type\":\"tel\",\"maxlength\":\"11\",\"placeholder\":\"手机号\",\"name\":\"phone\"},domProps:{\"value\":(_vm.phoneItem.value)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.phoneItem, \"value\", $event.target.value)}}}),_c('button',{staticClass:\"b-login__get-code\",attrs:{\"disabled\":_vm.countButtonDisabled},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onCountClick($event)}}},[_vm._v(_vm._s(this.countTimeout ? (\"已发送(\" + _vm.countValue + \"s)\")\n            : this.countButtonDirty? '重新获取' : '获取验证码'))])]),_c('div',{staticClass:\"b-login__form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.codeItem.value),expression:\"codeItem.value\"},{name:\"validate\",rawName:\"v-validate\",value:({ required: true, regex: /^\\w{6}$/ }),expression:\"{ required: true, regex: /^\\\\w{6}$/ }\"}],staticClass:\"b-login__form-control\",attrs:{\"type\":\"tel\",\"maxlength\":\"6\",\"placeholder\":\"验证码\",\"name\":\"code\"},domProps:{\"value\":(_vm.codeItem.value)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.codeItem, \"value\", $event.target.value)}}})]),_c('div',{staticClass:\"b-login__form-desc\"},[_c('span',[_vm._v(\"温馨提示：未注册饿了么账号的手机号，登录时将自动注册，且代表您已同意\")]),_c('router-link',{staticClass:\"b-login__user-agreement\",attrs:{\"to\":\"\"}},[_vm._v(\"《用户服务协议》\")])],1),_c('div',{staticClass:\"b-login__form-submit\"},[_c('button',{staticClass:\"b-login__submit-btn\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onLogin($event)}}},[_vm._v(\"登录\")])])]),_c('router-link',{staticClass:\"b-login__about\",attrs:{\"to\":\"\",\"tag\":\"p\"}},[_vm._v(\"关于我们\")])],1)]),_c('modal',{attrs:{\"visible\":_vm.captchaShow,\"closable\":false},on:{\"close\":function($event){_vm.captchaShow = false}}},[_c('div',{staticClass:\"captcha-panel\"},[_c('h2',{staticClass:\"captcha-panel__title\"},[_vm._v(\"请填写图形验证码\")]),_c('div',{staticClass:\"captcha-panel__content\"},[_c('div',{staticClass:\"captcha-panel__form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.captchaValue),expression:\"captchaValue\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.captchaValue)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.captchaValue=$event.target.value}}}),_c('img',{attrs:{\"src\":_vm.captchaImage,\"alt\":\"\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onRequestCaptcha($event)}}})]),_c('p',{staticClass:\"captcha-panel__error\"},[(_vm.captchaError)?_c('span',[_c('img',{attrs:{\"src\":require(\"./error.png\"),\"alt\":\"\"}}),_vm._v(\"验证码错误，请重新填写\\n          \")]):_vm._e()])]),_c('div',{staticClass:\"captcha-panel__btns\"},[_c('button',{staticClass:\"captcha-panel__btn captcha-panel__btn-cancel\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();_vm.captchaShow = false}}},[_vm._v(\"取消\")]),_c('button',{staticClass:\"captcha-panel__btn captcha-panel__btn-ok\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onSubmitCaptcha($event)}}},[_vm._v(\"确定\")])])])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"b-login__header-title\"},[_c('a',{staticClass:\"b-login__mobile-login\",attrs:{\"href\":\"javascript;\"}},[_c('span',[_vm._v(\"短信登录\")])])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"b-login__block\">\r\n    <div class=\"b-login__wrap\">\r\n      <header class=\"b-login__header\">\r\n        <div class=\"b-login__logo\">\r\n          <svg><use xlink:href=\"#logo\"></use></svg>\r\n        </div>\r\n        <div class=\"b-login__header-title\">\r\n          <a href=\"javascript;\"\r\n            class=\"b-login__mobile-login\"\r\n          >\r\n            <span>短信登录</span>\r\n          </a>\r\n        </div>\r\n      </header>\r\n      <div class=\"b-login__content\">\r\n        <form>\r\n          <div class=\"b-login__form-item\">\r\n            <input class=\"b-login__form-control\"\r\n              v-model=\"phoneItem.value\"\r\n              type=\"tel\"\r\n              maxlength=\"11\"\r\n              placeholder=\"手机号\"\r\n              name=\"phone\"\r\n              v-validate=\"{ required: true, regex: /^1\\d{10}$/ }\"\r\n            />\r\n            <button class=\"b-login__get-code\"\r\n              :disabled=\"countButtonDisabled\"\r\n              @click.stop.prevent=\"onCountClick\"\r\n            >{{ this.countTimeout ? `已发送(${countValue}s)`\r\n              : this.countButtonDirty? '重新获取' : '获取验证码' }}</button>\r\n          </div>\r\n          <div class=\"b-login__form-item\">\r\n            <input class=\"b-login__form-control\"\r\n              v-model=\"codeItem.value\"\r\n              type=\"tel\"\r\n              maxlength=\"6\"\r\n              placeholder=\"验证码\"\r\n              name=\"code\"\r\n              v-validate=\"{ required: true, regex: /^\\w{6}$/ }\"\r\n            />\r\n          </div>\r\n          <div class=\"b-login__form-desc\">\r\n            <span>温馨提示：未注册饿了么账号的手机号，登录时将自动注册，且代表您已同意</span>\r\n            <router-link to=\"\"\r\n              class=\"b-login__user-agreement\"\r\n            >《用户服务协议》</router-link>\r\n          </div>\r\n          <div class=\"b-login__form-submit\">\r\n            <button class=\"b-login__submit-btn\"\r\n              @click.stop.prevent=\"onLogin\"\r\n            >登录</button>\r\n          </div>\r\n        </form>\r\n        <router-link to=\"\" tag=\"p\"\r\n          class=\"b-login__about\"\r\n        >关于我们</router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <modal :visible=\"captchaShow\" :closable=\"false\"\r\n      @close=\"captchaShow = false\"\r\n    >\r\n      <div class=\"captcha-panel\">\r\n        <h2 class=\"captcha-panel__title\">请填写图形验证码</h2>\r\n        <div class=\"captcha-panel__content\">\r\n          <div class=\"captcha-panel__form-item\">\r\n            <input type=\"text\"\r\n              class=\"\"\r\n              v-model=\"captchaValue\"\r\n            >\r\n            <img :src=\"captchaImage\" alt=\"\"\r\n              @click.stop.prevent=\"onRequestCaptcha\"\r\n            >\r\n          </div>\r\n          <p class=\"captcha-panel__error\">\r\n            <span v-if=\"captchaError\">\r\n              <img src=\"./error.png\" alt=\"\">验证码错误，请重新填写\r\n            </span>\r\n          </p>\r\n        </div>\r\n        <div class=\"captcha-panel__btns\">\r\n          <button class=\"captcha-panel__btn captcha-panel__btn-cancel\"\r\n            @click.stop.prevent=\"captchaShow = false\"\r\n          >取消</button>\r\n          <button class=\"captcha-panel__btn captcha-panel__btn-ok\"\r\n            @click.stop.prevent=\"onSubmitCaptcha\"\r\n          >确定</button>\r\n        </div>\r\n      </div>\r\n    </modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { mapActions } from 'vuex'\r\n  import { Modal, Toast } from '@/components/common'\r\n  import { fetchMobileCode, fetchCaptcha } from '@/service/api'\r\n  import Vue from 'vue'\r\n  // import(/* webpackChunkName: 'vee-validate' */ 'vee-validate').then(VeeValidate => Vue.use(VeeValidate))\r\n  import VeeValidate from 'vee-validate'\r\n  Vue.use(VeeValidate)\r\n\r\n  const debug = true\r\n  debug && console.warn('[Debug] Login debug is activating')\r\n\r\n  export default {\r\n    name: 'Login',\r\n    components: {\r\n      Modal,\r\n    },\r\n    props: {\r\n\r\n    },\r\n    data() {\r\n      return {\r\n        phoneItem: {\r\n          value: '',\r\n        },\r\n        codeItem: {\r\n          value: '',\r\n        },\r\n\r\n        countButtonDisabled: true,\r\n        countButtonDirty: false,\r\n        countValue: '',\r\n        countTimeout: null,\r\n\r\n        captchaShow: false,\r\n        captchaError: false,\r\n        captchaValue: '',\r\n        captchaHash: '',\r\n        captchaImage: '',\r\n\r\n        validateToken: '',\r\n\r\n        errorMsgs: {\r\n          phone: {\r\n            required: '请输入正确的手机号',\r\n            regex: '请输入正确的手机号',\r\n          },\r\n          code: {\r\n            required: '请输入6位短信验证码',\r\n            regex: '请输入6位短信验证码',\r\n          },\r\n        }\r\n      }\r\n    },\r\n    watch: {\r\n      'phoneItem.value'(value) {\r\n        if (value.length >= 11 && !this.countTimeout) {\r\n          this.countButtonDisabled = false\r\n        } else {\r\n          this.countButtonDisabled = true\r\n        }\r\n      },\r\n    },\r\n    created() {\r\n      debug && (window[this.$options.name] = this)\r\n    },\r\n    methods: {\r\n      /* call APIs */\r\n      fetchMobileCode() {\r\n        const payload = {\r\n          mobile: this.phoneItem.value,\r\n          'captcha_hash': this.captchaHash,\r\n          'captcha_value': this.captchaValue,\r\n        }\r\n        return fetchMobileCode(payload)\r\n          .then(this.fetchMobileCodeFulfilled)\r\n          .catch(this.fetchMobileCodeRejected)\r\n      },\r\n      fetchCaptcha() {\r\n        // 调用接口\r\n        const payload = {\r\n          'captcha_str': this.phoneItem.value,\r\n        }\r\n        return fetchCaptcha(payload)\r\n          .then(this.fetchCaptchaFulfilled)\r\n      },\r\n      // loginByMobile() {\r\n      //   const payload = {\r\n      //     mobile: this.phoneItem.value,\r\n      //     validate_code: this.codeItem.value,\r\n      //     validate_token: this.validateToken,\r\n      //   }\r\n      //   return loginByMobile(payload)\r\n      //     .then(this.loginByMobileFulfilled)\r\n      // },\r\n      ...mapActions([\r\n        'loginByMobile',\r\n      ]),\r\n\r\n      /* event handlers */\r\n      onCountClick() {\r\n        this.setCount()\r\n        this.fetchMobileCode()\r\n      },\r\n      onRequestCaptcha() {\r\n        this.fetchCaptcha()\r\n      },\r\n      onSubmitCaptcha() {\r\n        this.fetchMobileCode()\r\n      },\r\n      onLogin() {\r\n        return this.$validator.validate()\r\n          .then((valid) => {\r\n            if (valid) {\r\n              const payload = {\r\n                mobile: this.phoneItem.value,\r\n                validate_code: this.codeItem.value,\r\n                validate_token: this.validateToken,\r\n              }\r\n              return this.loginByMobile(payload)\r\n                .then(this.loginByMobileFulfilled)\r\n                .catch(this.loginByMobileRejected)\r\n            } else {\r\n              const error = this.errors.items[0]\r\n              if (error) {\r\n                const msg = this.errorMsgs[error.field] && this.errorMsgs[error.field][error.rule]\r\n                  return Toast.open({\r\n                    content: msg,\r\n                    mask: false,\r\n                  })\r\n              }\r\n            }\r\n          })\r\n      },\r\n\r\n      fetchMobileCodeFulfilled({ validate_token }) {\r\n        this.validateToken = validate_token\r\n        this.captchaValue = ''\r\n        this.captchaError = false\r\n        this.captchaShow = false\r\n      },\r\n      fetchMobileCodeRejected({ name, message }) {\r\n        // 获取失败\r\n        if (name === \"NEED_CAPTCHA\") {\r\n          return this.fetchCaptcha()\r\n        }\r\n\r\n        if (name === \"CAPTCHA_CODE_ERROR\") {\r\n          this.captchaError = true\r\n          return this.fetchCaptcha()\r\n        }\r\n\r\n        if (name === \"HERMES_CLIENT_ERROR\") {\r\n          this.captchaShow = false\r\n          // 显示反馈信息\r\n          return Toast.open({\r\n            content: message,\r\n            mask: false,\r\n          })\r\n        }\r\n\r\n        if (name === \"INVALID_MOBILE\") {\r\n          this.captchaShow = false\r\n          // 显示反馈信息\r\n          return Toast.open({\r\n            content: message,\r\n            mask: false,\r\n          })\r\n        }\r\n      },\r\n      fetchCaptchaFulfilled({ captcha_hash, captcha_image }) {\r\n        // 显示图形验证码\r\n        this.captchaHash = captcha_hash\r\n        this.captchaImage = captcha_image\r\n        this.captchaShow = true\r\n      },\r\n      loginByMobileFulfilled() {\r\n        this.redirect()\r\n      },\r\n      loginByMobileRejected({ name, message }) {\r\n        this.code = ''\r\n        let content = message\r\n        if (name === 'INVALID_VALIDATE_TOKEN') {\r\n          content += '，请尝试重新获取验证码'\r\n        }\r\n        return Toast.open({\r\n          content,\r\n          mask: false,\r\n          duration: 4,\r\n        })\r\n      },\r\n\r\n      redirect() {\r\n        this.$router.replace(this.$route.query.redirect || '/')\r\n      },\r\n\r\n      setCount() {\r\n        this.countButtonDirty = true\r\n        this.countValue = 30\r\n        this.countButtonDisabled = true\r\n        const step = (() => {\r\n          if (this.countValue--) {\r\n            this.countTimeout = setTimeout(step, 1000)\r\n          } else {\r\n            this.cancelCount()\r\n          }\r\n        })\r\n        step()\r\n      },\r\n      cancelCount() {\r\n        clearTimeout(this.countTimeout)\r\n        this.countValue = ''\r\n        this.countButtonDisabled = false\r\n        this.countTimeout = null\r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .b-login {@at-root{\r\n\r\n    .b-login__block {\r\n      box-sizing: border-box;\r\n      flex: 1 0 auto;\r\n      padding-top: 80px;\r\n      min-height: 100%;\r\n      background-color: #fff;\r\n    }\r\n    .b-login__wrap {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      width: 600px;\r\n      margin: auto;\r\n    }\r\n    .b-login__header {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n    }\r\n    .b-login__logo {\r\n      width: 280px;\r\n      height: 112px;\r\n      svg {\r\n        width: 100%;\r\n        width: 100%;\r\n      }\r\n    }\r\n    .b-login__header-title {\r\n      display: flex;\r\n      justify-content: center;\r\n      margin-top: 80px;\r\n    }\r\n    .b-login__mobile-login {\r\n      width: 116px;\r\n      padding-bottom: 8px;\r\n      margin: 0 20px;\r\n      font-size: 28px;\r\n      font-weight: 700;\r\n      cursor: pointer;\r\n\r\n      color: #2395ff;\r\n      border-bottom: 4px solid #2395ff;\r\n    }\r\n    .b-login__content {\r\n\r\n    }\r\n    .b-login__form-item {\r\n      box-sizing: border-box;\r\n      position: relative;\r\n      margin-top: 32px;\r\n      height: 96px;\r\n      font-size: 28px;\r\n      background-color: #fff;\r\n    }\r\n    .b-login__form-control {\r\n      padding: 2px 2px 2px 20px;\r\n      width: 100%;\r\n      height: 100%;\r\n      border-radius: 8px;\r\n      border: 2px solid #ddd;\r\n      color: #333;\r\n      -webkit-appearance: none;\r\n      &:focus {\r\n        border-color: #0089dc;\r\n      }\r\n    }\r\n    .b-login__get-code {\r\n      position: absolute;\r\n      z-index: 5;\r\n      top: 50%;\r\n      right: 20px;\r\n      transform: translateY(-50%);\r\n\r\n      padding: 0;\r\n      text-align: center;\r\n      font-size: 28px;\r\n      border-radius: 12px;\r\n      color: #2385ff;\r\n      background-color: transparent;\r\n\r\n      &[disabled] {\r\n        color: #ccc;\r\n      }\r\n    }\r\n    .b-login__form-desc {\r\n      margin-top: 24px;\r\n      font-size: 28px;\r\n      line-height: 40px;\r\n      color: #999;\r\n    }\r\n    .b-login__user-agreement {\r\n      color: #2395ff;\r\n    }\r\n    .b-login__submit-btn {\r\n      display: block;\r\n      width: 100%;\r\n      height: 82px;\r\n      margin-top: 60px;\r\n      text-align: center;\r\n      font-size: 32px;\r\n      line-height: 82px;\r\n      border-radius: 8px;\r\n      background-color: #4cd96f;\r\n      color: #fff;\r\n      cursor: pointer;\r\n    }\r\n    .b-login__about {\r\n      text-align: center;\r\n      margin-top: 40px;\r\n      font-size: 24px;\r\n      color: #999;\r\n    }\r\n\r\n  }}\r\n\r\n  .captcha-panel {@at-root{\r\n\r\n    .captcha-panel {\r\n      overflow: hidden;\r\n      width: 580px;\r\n      border-radius: 10px;\r\n      background: rgba(255, 255, 255, .9);\r\n    }\r\n    .captcha-panel__title {\r\n      text-align: center;\r\n      font-size: 40px;\r\n      font-weight: 700;\r\n      margin: 44px 0;\r\n      color: #000;\r\n    }\r\n    .captcha-panel__content {\r\n    }\r\n    .captcha-panel__form-item {\r\n      margin: 0 28px;\r\n      display: flex;\r\n      background-color: #fff;\r\n      input {\r\n        flex: 1;\r\n        width: 100%;\r\n        height: 86px;\r\n        padding: 0 24px;\r\n        font-size: 36px;\r\n      }\r\n      img {\r\n        width: 200px;\r\n        height: 68px;\r\n        margin: 9px;\r\n      }\r\n    }\r\n    .captcha-panel__error {\r\n      display: flex;\r\n      margin: 20px 30px;\r\n      font-size: 26px;\r\n      height: 26px;\r\n      color: #ff6000;\r\n      img {\r\n        vertical-align: middle;\r\n        width: 30px;\r\n        height: 30px;\r\n        margin-right: 6px;\r\n      }\r\n    }\r\n    .captcha-panel__btns {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      border-top: 1px solid #ddd; /*no*/\r\n    }\r\n    .captcha-panel__btn {\r\n      flex: 1;\r\n      font-size: 34px;\r\n      height: 88px;\r\n      border: 1px solid #ddd; /*no*/\r\n      background: none;\r\n      color: #666;\r\n      &:active {\r\n        opacity: .7;\r\n      }\r\n    }\r\n    .captcha-panel__btn-cancel {\r\n\r\n    }\r\n    .captcha-panel__btn-ok {\r\n      border: none;\r\n      font-weight: 700;\r\n      color: #3190e8;\r\n    }\r\n\r\n  }}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=d548d02e&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=d548d02e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d548d02e\",\n  null\n  \n)\n\ncomponent.options.__file = \"Login.vue\"\nexport default component.exports","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAxZJREFUSA21V8tqFEEUPdUGYXytfKCILvQbMkjyAQoqbnThKhkwqB8g7jJRF+IHaFDIZBniwkcSdC1R7Fm7040ulMSAoBLBR8pzb1cz7Ux1T/VMW1DTNVX3nlOPW/feMihRbAO7YTCKPzjA7yFVtfiIbViDRdvM4VsonOknaJvYjveYotxp1jHWNknWEZFQyhYnYLCfrVHWl6zLOIr7pomfbOeWXGJrCdfABEma1I75bxE1PDd38d2HZq9iF37gJOUvcLxO+SbmMG8MezzFS2ynsAO/sED5vQS4xi1c9ejmdvFIxkl3hwIbnOxF32R7iHXmmzwrgyXTwtlc9IABO4lZTmCcx3Ki+/yjrL4jfU3SW8OSCi4xLhPrEe3gq+5ilixty5lyhkt2AvfSvqIvZVcou1wkk45R9qlWsZvuQpAGa/BZUtZK7cbJ+0/iV6yT6bhutV4ZYJpncT0dqPxLI+U0m46LVFI+4BJ/47LWq7qBPw47dj7BEVuc4e4vBmIMLpZwiCNCpG5QPBKdw+CIgZoJx5hwRlypuLq275IHwgWLOY62cEa8Y+JnPwdrDysofp5BRlYsUSZx+MOChuhLcCHnP54rRK8qmYh3S1abxNaqUItwJIySc4QXap3nvK9INmdsJae/uFtid4Q1o9dJVl3Dwf9t2S5mf9Iz1nBl6aM3cap4qhWMSqLALEU4E+OKNMqcrwC6GCLJTjSiJcRH8IAadc0cilV1lLH1GCPNW61sB6jAYdclHxN5JXaJ2QyN7HYICH7jHC3zuFZphxRJhZiHpUlg5x630OLAF67iSV+cETym7Dut0u5TiDlLkQ1J/ryikp64AH/DKzBAJ0lvEvONWnRGvycVcSYfcxtfmHlcyciWburuWSaMEfbo7ckgdLbadepdrmlefJgzXQ01uAymGpLosi/ic2BnN6nI9qw4BdCEPsmRptkXsz5ktv0sz8m4neok9MAMraZVKqFPyeWrOZKkRlt8whjmyPKEScJoGtHEz4vLTZ4wzMfB65laL/u9JXfFPml1r5I4SAzPPtrE35d8tP0F950EOn4oQmQAAAAASUVORK5CYII=\""],"sourceRoot":""}